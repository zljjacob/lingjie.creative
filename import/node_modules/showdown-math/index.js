const sd = require('showdown')
const a2l = require('asciimath-to-latex')
const katex = require('katex')

const convertTex = (t, inline) => {

    return katex.renderToString(t, {displayMode: !inline}).replace(/_/g, '\\_')
}

const convertAscii = (t, inline) => {

    return convertTex(a2l(t), inline)
}

// $ characters are replaced with ¨D
// charactes by showdown.
// I do not know why..

// Todo: escaping?

module.exports = [{
        type: 'lang',
        regex: /¨D¨D([\s\S]*?)¨D¨D/gm,
        replace: (text, match) => { return convertTex(match, false) }
},
{
        type: 'lang',
        regex: /¨D([\s\S]*?)¨D/gm,
        replace: (text, match) => { return convertTex(match, true) }
},
{
        type: 'lang',
        regex: /%%([\s\S]*?)%%/gm,
        replace: (text, match) => { return convertAscii(match, false) }
},
{
        type: 'lang',
        regex: /%([\s\S]*?)%/gm,
        replace: (text, match) => { return convertAscii(match, true) }
}]







